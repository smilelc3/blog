---
title:  服务器4线风扇接口定义以及转速读取机制
date: 2025-3-5
---

# 服务器4线风扇接口定义以及转速读取机制

一般服务器或交换机上的风扇接口都会走以下几种信号：

| 线定义      | 线常用颜色 | 功能描述                     |
| ----------- | ---------- | ---------------------------- |
| POWER/VCC   | 红色       | 供电，一般为12V              |
| GND         | 黑色       | GND接地                      |
| PWM         | 蓝色       | 调速信号，方波占空比         |
| **TACH/FG** | 黄色或白色 | 测速信号，可用作**闭环控制** |

![](https://raw.githubusercontent.com/smilelc3/blog/main/images/服务器4线风扇接口定义以及转速读取机制/FDT5NAUIZ6BZC2P.png)

`TACH`（Tachometer）信号，转速表的意思，一些说明书里也被称为FG（Frequency Generator）信号。注意`TACH`是开集电极输出，需要上拉电阻。

`TACH`信号输出的是一个**频率可变**的方波信号。其原理是，在风扇转子旁边布置了一个霍尔传感器，当电机转动的时候，电机的转子的磁体经过霍尔传感器时，输出一个高电平，经过信号处理后输出一个方波。因为转子转一圈一般会输出**2**个方波信号，因此方波的**2**个周期的时间就是电机转子转动一圈的时长。因此，电机转速 $rpm=Freq_{方波}*60/2$ ，单位为 $rad/min$ 。

在实际检测电路中，定义常量 $N_{puls}$ 表示风扇每转一圈产生**脉冲个数**，一般为**2**；定义一个测量时间窗 $T_{mea}$ （例如500ms）；设置一个计数器 $M$（例如8bit），用于统计时间窗内收到的脉冲数； 那么风扇转速为： $rpm = M*60 /(T_{mea} * N_{puls})$ ，单位为 $rad/min$ 。因为计数器 $M$ 存在最大值，如果风扇的满转速过高，需要配置减小测量的时间窗以匹配。