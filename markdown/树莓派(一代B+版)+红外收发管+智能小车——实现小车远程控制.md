---
title: æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶
date: 2017-07-01
---

å‰æ®µæ—¶é—´çš„ï¼Œæ–°ç”Ÿå·¥ç¨‹ä½“éªŒè¯¾ä¸Šï¼Œä¸¤äººä¸€ç»„ï¼Œé å‚å®¶æä¾›çš„å…ƒå™¨ä»¶å’Œçƒ§å½•ä»£ç ï¼Œç„Šæ¥äº†äº†ä¸€å°æ™ºèƒ½å°è½¦ã€‚

æœ€è¿›ï¼Œç¢°å·§æ‰‹å¤´æœ‰ç©ºé—²çš„ä¸€å—æ ‘è“æ´¾ï¼Œæœ¬æ¥æ‰“ç®—ç”¨æ ‘è“æ´¾å»å®ç°è¿œç¨‹æ§åˆ¶ç©ºè°ƒï¼Œä½†å‘ç°ç©ºè°ƒçš„çº¢å¤–ç¼–ç å¸¦æœ‰é€»è¾‘æ§åˆ¶ï¼Œåªèƒ½é€€è€Œæ±‚å…¶æ¬¡ï¼Œè¯•è¯•è¿œç¨‹æ§åˆ¶å°è½¦ï¼Œå¤§ä½“æ¡†æ¶ç»“æ„å¦‚å›¾ã€‚

---

2017-07-03æ›´æ–°ï¼Œå·²ç»å®ç°å¯¹ç©ºè°ƒç±»å¸¦é€»è¾‘ç¼–ç è®¾å¤‡çš„ç®€å•æ§åˆ¶ã€‚

---

![](https://raw.githubusercontent.com/smilelc3/blog/main/images/æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶/unnamed-file%20[åŸå§‹å¤§å°].jpg)

# çƒ§å½•ç³»ç»Ÿ

å‡ ä¹æ‰€æœ‰çš„æ–°æ‰‹æ•™ç¨‹éƒ½ä½¿ç”¨[Win32DiskImager](https://sourceforge.net/projects/win32diskimager/)ä½œä¸ºç³»ç»Ÿå®‰è£…å·¥å…·â€”â€”ä¸­æ–‡çš„ã€è‹±æ–‡çš„ã€å®˜æ–¹çš„ã€eLinux wikiçš„ï¼Œä¸ä¸€è€Œè¶³ã€‚
ä½†æ˜¯è¿™ä¸ªå·¥å…·ä¸æ”¯æŒä¸­æ–‡ç›®å½•åï¼ˆæ–‡ä»¶æˆ–ç›®å½•æœ‰ä¸­æ–‡ï¼Œä¼šå‡ºç°123é”™è¯¯ï¼‰ï¼Œä¸æ”¯æŒå‹ç¼©ï¼Œå¿…é¡»å…ˆæ’å¥½SDå¡ï¼Œå†å¼€è½¯ä»¶ã€‚
è€Œ[USB Image Tool](https://www.techspot.com/downloads/6355-usb-image-tool.html)ï¼Œå°±æ˜¯Win32DiskImagerçš„ä¸€ä¸ªæ›´æ–¹ä¾¿çš„æ›¿ä»£å“ã€‚

![](https://raw.githubusercontent.com/smilelc3/blog/main/images/æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶/20130831204912500-0-1.jpg)

## å†™SDå¡ï¼šç›´æ¥è¯»å–zipå‹ç¼©åŒ…

USB Image Toolå¯ä»¥ç›´è¯».zipå‹ç¼©åŒ…ã€‚ç½‘ä¸Šä¸‹è½½çš„zipæ ¼å¼ç³»ç»Ÿé•œåƒï¼Œä¸‹å®Œç›´æ¥å¯ä»¥çƒ§å½•ã€‚
ç‚¹å‡»**Restore**ï¼Œé€‰æ‹©.zipæ–‡ä»¶å³å¯ã€‚æ³¨æ„æ‰“å¼€å¯¹è¯æ¡†ä¸­é»˜è®¤çœ‹ä¸åˆ°.zipæ–‡ä»¶ï¼Œåœ¨â€œæ–‡ä»¶ç±»å‹â€å¤„é€‰æ‹©â€œ**All Files (*.*)**â€å³å¯ã€‚

##  SSHæ— æ³•è¿æ¥é—®é¢˜

è‡ªä»2016å¹´11æœˆå¼€å§‹ï¼Œæ ‘è“æ´¾å®˜æ–¹æ¨è [Raspbian](https://www.raspberrypi.org/downloads/raspbian/) ç³»ç»Ÿé•œåƒå…³é—­äº†é»˜è®¤*ssh*è¿æ¥ï¼Œé‡æ–°å¼€å¯ä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠSDå¡æ‹”ä¸‹æ¥ï¼Œè¿›å…¥åˆ°æ ¹ç›®å½•ï¼Œæ–°å»ºä¸€ä¸ªåä¸º*ssh*çš„ç©ºç™½æ–‡ä»¶(æ— åç¼€)å°±å¯ä»¥ã€‚

å¥½äº†ç„¶åå†æŠŠå¡æ’å›æ ‘è“æ´¾ï¼Œå°±å¯ä»¥ä½¿ç”¨SSHäº†ã€‚

* åˆå§‹ç”¨æˆ·åï¼š**pi**
* åˆå§‹å¯†ç ï¼š**raspberry**

# å°†çº¢å¤–æ¥å—ç®¡å’Œå‘å°„ç®¡è¿æ¥è‡³æ ‘è“æ´¾GPIOæ¥å£

**ææ–™ï¼š**

çº¢å¤–æ¥å—ç®¡ï¼ˆ3pinï¼‰ï¼Œçº¢å¤–æ¥å—ç®¡ï¼ˆ2pinï¼‰,æœé‚¦çº¿è‹¥å¹²ã€‚

æ ¹æ®ä¸åŒæ ‘è“æ´¾ç‰ˆæœ¬ï¼ŒæŸ¥çœ‹GPIOçš„å¼•çº¿å›¾ï¼Œè¯¥å®éªŒé‡‡ç”¨B+ç‰ˆï¼Œå…·ä½“å®ç‰©å¯¹åº”å›¾å’Œ**GPIO**ä¸pinå¯¹åº”å›¾å¦‚ä¸‹å›¾ï¼š

![](https://raw.githubusercontent.com/smilelc3/blog/main/images/æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶/6619373360026755635-1.jpg)

![](https://raw.githubusercontent.com/smilelc3/blog/main/images/æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶/c259e358ccbf6c813fdb4c76bb3eb13531fa409f-1.png)

## ç¡¬ä»¶è¿æ¥

**çº¢å¤–æ¥æ”¶å™¨** 

* vcc è¿ pin1 (3.3v)

* gnd è¿ pin6(ground)

* data è¿ pin12(gpio18)

**çº¢å¤–å‘å°„å™¨**

* gnd è¿ pin25(ground)

* data è¿ pin11(gpio17)

**çº¢å¤–æ¥å—å™¨è§„æ ¼è§å›¾ï¼Œå·¦å¼•è„šä¸ºdataï¼Œä¸­ä¸ºæ¥åœ°ï¼Œå³ä¸º3.3Vä¾›ç”µ**

![](https://raw.githubusercontent.com/smilelc3/blog/main/images/æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶/20120921154663386338-1.jpg)

**çº¢å¤–å‘å°„å™¨è§„æ ¼è§å›¾ï¼Œé•¿è„šä¸ºdata,çŸ­è„šä¸ºæ¥åœ°**

![](https://raw.githubusercontent.com/smilelc3/blog/main/images/æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶/201453125427363-1.jpg)

æ¥æ”¶å™¨å’Œå‘å°„å™¨é€šè¿‡æœé‚¦çº¿è·Ÿæ ‘è“æ´¾ç›¸è¿ï¼Œæœ€åçš„è¿æ¥å®ç‰©å›¾

![](https://raw.githubusercontent.com/smilelc3/blog/main/images/æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶/20170701222333.jpg)

# é¢„å…ˆè§£ææ§åˆ¶ç 

## ä¿®æ”¹ raspbian ä»“åº“é»˜è®¤æº

1. ä¿®æ”¹aptæº

```bash
sudo nano /etc/apt/sources.list
```

  ä¾‹å¦‚ä½¿ç”¨å¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢è½¯ä»¶æºé•œåƒï¼Œä¿®æ”¹ä¹‹åçš„å†…å®¹å¦‚ä¸‹ï¼š

```bash
deb http://mirrors.aliyun.com/raspbian/raspbian jessie main contrib non-free rpi
```

å…¶ä»–å¯ç”¨æºå¦‚ä¸‹ï¼š

* ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦
  Raspbian <http://mirrors.ustc.edu.cn/raspbian/raspbian/>

* é˜¿é‡Œäº‘
  Raspbian <http://mirrors.aliyun.com/raspbian/raspbian/>

* æ¸…åå¤§å­¦
  Raspbian <http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/>

* åä¸­ç§‘æŠ€å¤§å­¦
  Raspbian <http://mirrors.hustunique.com/raspbian/raspbian/>
  Arch Linux ARM <http://mirrors.hustunique.com/archlinuxarm/>

* åå—å†œä¸šå¤§å­¦ï¼ˆåå—ç”¨æˆ·ï¼‰
  Raspbian <http://mirrors.scau.edu.cn/raspbian/>

* å¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢æºï¼ˆåŒ—æ–¹ç”¨æˆ·ï¼‰
  Raspbian <http://mirrors.neusoft.edu.cn/raspbian/raspbian/>

* é‡åº†å¤§å­¦æºï¼ˆä¸­è¥¿éƒ¨ç”¨æˆ·ï¼‰

  Raspbian <http://mirrors.cqu.edu.cn/Raspbian/raspbian/>

2. æ›´æ–°è½¯ä»¶æºå’Œè½¯ä»¶

```bash
# æ›´æ–°è½¯ä»¶æº
sudo apt-get update
# æ›´æ–°è½¯ä»¶
sudo apt-get upgrade
```

## æ›´æ¢viæ–‡æœ¬ç¼–è¯‘å™¨ä¸ºvim

å› ä¸ºviåœ¨insertæ¨¡å¼ä¸‹ï¼Œæ–¹å‘é”®ä¼šå˜ä¸ºABCDï¼Œæ•…ç”¨vimè¿›è¡Œæ›¿æ¢

```bash
#å¸è½½vi
sudo apt-get remove vi-common
#å®‰è£…vim
sudo apt-get install -y vim
```

## å®‰è£…lirc

LIRC (*Linux Infrared remote control*)æ˜¯ä¸€ä¸ªlinuxç³»ç»Ÿä¸‹å¼€æºçš„è½¯ä»¶åŒ…ã€‚è¿™ä¸ªè½¯ä»¶å¯ä»¥è®©Linuxç³»ç»Ÿæ¥æ”¶åŠå‘é€çº¢å¤–çº¿ä¿¡å·ã€‚

```bash
sudo apt-get install lirc
```

**é…ç½®ç¡¬ä»¶**

```bash
# sudo vim /boot/config.txt #åœ¨æ–‡ä»¶ç»“å°¾æ·»åŠ 
# ä¿®æ”¹ä¸€ä¸‹å†…å®¹
dtoverlay=lirc-rpi
gpio_in_pin=18
gpio_out_pin=17

# sudo vim /etc/lirc/hardware.conf  #ç¼–è¾‘LRICçš„é…ç½®æ–‡ä»¶
# ä¿®æ”¹ä»¥ä¸‹å†…å®¹
LIRCD_ARGS="--uinput"
DRIVER="default"
DEVICE="/dev/lirc0"
MODULES="lirc_rpi"

# é‡å¯ç”Ÿæ•ˆ
sudo /etc/init.d/lirc restart
```

**æ³¨æ„ï¼š**é…ç½®gpio_in_pinå’Œgpio_out_pinæ—¶ï¼Œç¼–å·ä¸ºGPIOå·ï¼Œå¹¶épinå· 

**å¯åŠ¨æµ‹è¯•**

```bash
sudo mode2 -d /dev/lirc0
```

çº¢å¤–æ¥æ”¶å™¨å·²ç»æ‰“å¼€ï¼Œå¤„äºç›‘å¬çŠ¶æ€ã€‚è¿™ä¸ªæ—¶å€™ï¼Œåˆ©ç”¨ä»»ä½•çº¢å¤–å‘å°„å™¨ï¼ˆå¯ä»¥æ˜¯ç”µè§†é¥æ§å™¨æˆ–å…¶ä»–é¥æ§å™¨ï¼‰å¯¹çº¢å¤–æ¥æ”¶æ¨¡å—æŒ‰ä»»æ„æŒ‰é’®ï¼Œå°±å¯ä»¥åœ¨æ ‘è“æ´¾ç»ˆç«¯ä¸Šçœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„ä»£ç 

çœ‹åˆ°è¿™ä¸ªä»£ç ä¾¿è¯æ˜çº¢å¤–æ¥æ”¶æ¨¡å—æ˜¯æ­£å¸¸å·¥ä½œçš„ã€‚

å¦‚æœæ²¡æœ‰çœ‹åˆ°ï¼Œè¯·æ£€æŸ¥ä½ çš„æ¥çº¿ã€ç”µå‹ã€ä»¥åŠé€šè¿‡**lsusb**æŸ¥çœ‹æ˜¯å¦åŠ è½½äº†ç›¸åº”æ¨¡å—ã€‚

```
pulse 1681
space 4816
pulse 1695
space 4784
pulse 1333
space 3638
```

## å½•åˆ¶è§£ææ§åˆ¶ç 

1. å¼€å§‹å½•åˆ¶

```bash
irrecord -d /dev/lirc0 ~/lircd.conf #æŒ‰ç…§æç¤ºæ“ä½œå³å¯,å½•åˆ¶å®Œåä¼šè®©ä½ è¾“å…¥æŒ‰é”®å
```

2. æŸ¥çœ‹å¯ç”¨é”®ååˆ—è¡¨

```bash
irrecord --list-namespace
```

3. å°†å·²å½•åˆ¶çš„ç¼–ç åŠ è½½è¿› *lirc* é…ç½®å‚æ•°

```bash
sudo cp ~/lircd.conf /etc/lirc/lircd.conf
```

# é€šè¿‡æ ‘è“æ´¾å‘å°„çº¢å¤–ç¼–ç 

1. å¯åŠ¨lircdæœåŠ¡

```bash
sudo lircd -d /dev/lirc0
```

2. æŸ¥çœ‹å½•åˆ¶å¥½å¯ä»¥ä½¿ç”¨çš„é”®å

```bash
irsend LIST /home/pi/lircd.conf ""
```

3. å‘é€çº¢å¤–ç¼–ç 

```bash
irsend SEND_ONCE /home/pi/lircd.conf KEY_XXX
```

**æ¼”ç¤ºæ•ˆæœ**

<video src="https://raw.githubusercontent.com/smilelc3/blog/main/images/æ ‘è“æ´¾(ä¸€ä»£B+ç‰ˆ)+çº¢å¤–æ”¶å‘ç®¡+æ™ºèƒ½å°è½¦â€”â€”å®ç°å°è½¦è¿œç¨‹æ§åˆ¶/VID_20170701_211221_1-1.mp4" controls preload="metadata"></video>

---

**å…³äºå½•åˆ¶å¸¦é€»è¾‘ç¼–ç çš„çº¢å¤–ç¼–ç **

ä¸€ä¸ªæ¯”è¾ƒä»¤äººå…´å¥‹çš„æ¶ˆæ¯ï¼Œè°¢è°¢åšå®¢<http://blog.just4fun.site/raspberrypi-lirc.html>çš„å¸®åŠ©ï¼Œç›´æ¥å‘é€rawåŸå§‹ç å°±å¯ä»¥å®ç°ç®€å•çš„æ§åˆ¶ç¨‹åºã€‚ğŸ˜˜

**æ³¨æ„ï¼š**å…¶åªèƒ½ä½¿ç”¨rawåŸå§‹ç ï¼Œè®°å½•æ˜¯é€šè¿‡mode2å‘½ä»¤å®ç°ã€‚

1. åˆ¶ä½œæ¨¡ç‰ˆï¼ˆä¸è®¾ç½®æŒ‰é”®ï¼Œåˆå§‹åŒ–ç©ç›´æ¥è·³è¿‡ï¼‰

```bash
sudo /etc/init.d/lirc restart
irrecord  -f -d /dev/lirc0 ~/lircd.conf
```

2. å½•åˆ¶éœ€è¦å®ç°çš„æŒ‰é”®

```bash
mode2  -d /dev/lirc0 > /tmp/temp.code  
cat /tmp/temp.code | sed -n '2,$p' | grep -o  -E "[0-9]+" | xargs echo  # ç§»é™¤ç¬¬ä¸€è¡Œ,ä¹‹åæŠŠæ‰€æœ‰æ•°å­—å–å‡º

# æŠŠä¸Šè¿°æŒ‡ä»¤å†™å…¥ ~/lircd.conf çš„ KEY_OPENé‡Œ
# å€¼å¾—æ³¨æ„çš„æ˜¯ ~/lircd.confæ–‡ä»¶é‡Œçš„ç©ºæ ¼ååˆ†é‡è¦

sudo cp ~/lircd.conf /etc/lirc/lircd.conf
sudo /etc/init.d/lirc restart
# irsend LIST /home/pi/lircd.conf "" #åˆ—å‡ºæŒ‡ä»¤
```

3. æœ€åä¸€ä¸ªå‚è€ƒæ ¼å¼çš„***lircd.conf***æ–‡ä»¶ï¼ˆä¿è¯ç©ºæ ¼æ­£ç¡®ï¼‰

```bash
begin remote

  name  /home/pi/lircd.conf
  flags RAW_CODES
  eps            30
  aeps          100

  gap          8015

      begin raw_codes

          name KEY_POWER
               8927 4522 531 1711 551 1706 559 598 549 599 551 600 551 598 551 597 552 1719 558 597 549 1715 549 1724 540 614 535 592 559 597 550 599 551 610 551 602 549 598 553 1706 558 598 549 601 549 599 550 601 548 614 551 593 557 1717 545 598 551 598 552 598 552 599 549 598 553 1720 556 597 563 589 549 600 549 601 549 607 545 593 555 599 551 614 548 598 551 598 551 600 550 594 604 548 555 597 551 599 551 597 573 7967 558 597 549 598 548 603 548 601 554 598 550 599 550 600 545 619 549 600 545 599 556 598 551 600 549 611 541 597 551 599 551 609 548 601 555 598 552 596 554 598 550 598 563 587 551 600 543 615 556 598 550 598 551 599 576 574 552 596 552 598 552 613 538 612 551 595 552 597 553 598 552 599 552 596 552 1720 545 596 552 610 551 599 551 599 575 575 551 593 559 595 553 598 552 598 549 612 552 598 551 1705 559 597 574 1689 550 1724 540 598 552 592 559 609 553 599 548 598 552 1711 551 1705 560 1708 553 1711 550 599 553 1716 563 7970 559 597 551 600 573 578 550 599 551 600 575 573 565 589 575 586 552 1710 554 597 556 596 553 597 549 604 552 600 550 599 551 614 551 598 552 599 552 599 548 602 553 598 550 1713 552 599 552 613 593 558 545 604 564 586 552 598 552 598 554 595 554 601 546 617 546 607 550 597 551 611 541 597 553 598 553 598 580 572 548 615 552 599 554 596 552 599 551 598 554 598 547 614 536 604 552 609 554 1714 548 598 556 597 548 599 553 601 553 1711 553 598 553 593 549

      end raw_codes

end remote
```

4. å¯åŠ¨æœåŠ¡ï¼Œè¿è¡ŒæŒ‡ä»¤

```bash
sudo lircd -d /dev/lirc0
irsend SEND_ONCE /home/pi/lircd.conf KEY_POWER
```